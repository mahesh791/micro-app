pipeline {
  agent { dockerfile true }
  stages {
    stage('archive') {
      steps {
        sh '''
          ls
        '''
      }
    }
    stage('Push Version') {
    environment {
            GIT_AUTH = credentials('github_cred')
        }
      steps {
        sh '''
          git --version
          git config user.email "deoremahesh791@gmail.com"
          git config user.name "Mahesh"
          git config --local credential.helper "!f() { echo username=\\$GIT_AUTH_USR; echo password=\\$GIT_AUTH_PSW; }; f"
          sleep 50
          git pull origin main
          echo "\n"$(date) $BUILD_NUMBER >> versions
          git add . && git commit -m \"Added ${BUILD_NUMBER}\"
          git push origin HEAD:main
          #test
        '''
      }
    }
  }
}
